<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- saved from url=(0054)http://www-cs-students.stanford.edu/~tjw/jsbn/rsa.html -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>JavaScript RSA Encryption Demo</title>
    <script language="JavaScript" type="text/javascript" src="./js/jsbn.js"></script>
    <script language="JavaScript" type="text/javascript" src="./js/prng4.js"></script>
    <script language="JavaScript" type="text/javascript" src="./js/rng.js"></script>
    <script language="JavaScript" type="text/javascript" src="./js/rsa.js"></script>
    <script language="JavaScript" type="text/javascript" src="./js/base64.js"></script>
    <script language="JavaScript">
<!--
function set_512e3() {
  document.rsatest.n.value="BC86E3DC782C446EE756B874ACECF2A115E613021EAF1ED5EF295BEC2BED899D\n26FE2EC896BF9DE84FE381AF67A7B7CBB48D85235E72AB595ABF8FE840D5F8DB";
  document.rsatest.e.value="3";
}
function set_512f4() {
  document.rsatest.n.value="C4E3F7212602E1E396C0B6623CF11D26204ACE3E7D26685E037AD2507DCE82FC\n28F2D5F8A67FC3AFAB89A6D818D1F4C28CFA548418BD9F8E7426789A67E73E41";
  document.rsatest.e.value="10001";
}
function set_1024e3() {
  document.rsatest.n.value="ABC30681295774F7CECA691EC17F4E762DA6DE70F198EAEE3CCE3A435FC006B9\n71DC24E55904F1D2705758C041C2B0B18E8BFAE2C9CD96B50082D7D8C7342CBA\nB7F6E0622DA53B8B56DBDB24174F00173263CFECAE604795CDA2A037BC3A69B7\nC0090AA2DE1568998BCD6D70CC2E0574755B9F7986AE01CE8714A26144279CDB";
  document.rsatest.e.value="3"
}
function set_1024f4() {
  document.rsatest.n.value="a5261939975948bb7a58dffe5ff54e65f0498f9175f5a09288810b8975871e99\naf3b5dd94057b0fc07535f5f97444504fa35169d461d0d30cf0192e307727c06\n5168c788771c561a9400fb49175e9e6aa4e23fe11af69e9412dd23b0cb6684c4\nc2429bce139e848ab26d0829073351f4acd36074eafd036a5eb83359d2a698d3";
  document.rsatest.e.value="10001";
}
function do_encrypt() {
  var before = new Date();
  var rsa = new RSAKey();
  rsa.setPublic(document.rsatest.n.value, document.rsatest.e.value);
  var res = rsa.encrypt(document.rsatest.plaintext.value);
  var after = new Date();
  if(res) {
    document.rsatest.ciphertext.value = linebrk(res, 64);
    document.rsatest.cipherb64.value = linebrk(hex2b64(res), 64);
    document.rsatest.status.value = "Time: " + (after - before) + "ms";
  }
}
//-->

    </script>
</head>


<body onload="set_1024f4();" onclick="rng_seed_time();" onkeypress="rng_seed_time();">
<h1>JavaScript RSA Encryption Demo</h1>

<form name="rsatest" onsubmit="do_encrypt();return false;">
    Plaintext (string):<br>
    <input name="plaintext" type="text" value="test" size="40"
           style="cursor: auto; background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABHklEQVQ4EaVTO26DQBD1ohQWaS2lg9JybZ+AK7hNwx2oIoVf4UPQ0Lj1FdKktevIpel8AKNUkDcWMxpgSaIEaTVv3sx7uztiTdu2s/98DywOw3Dued4Who/M2aIx5lZV1aEsy0+qiwHELyi+Ytl0PQ69SxAxkWIA4RMRTdNsKE59juMcuZd6xIAFeZ6fGCdJ8kY4y7KAuTRNGd7jyEBXsdOPE3a0QGPsniOnnYMO67LgSQN9T41F2QGrQRRFCwyzoIF2qyBuKKbcOgPXdVeY9rMWgNsjf9ccYesJhk3f5dYT1HX9gR0LLQR30TnjkUEcx2uIuS4RnI+aj6sJR0AM8AaumPaM/rRehyWhXqbFAA9kh3/8/NvHxAYGAsZ/il8IalkCLBfNVAAAAABJRU5ErkJggg==); background-attachment: scroll; background-position: 100% 50%; background-repeat: no-repeat;">
    <input type="button" value="encrypt" onclick="do_encrypt();">

    <p>
        Ciphertext (hex):<br>
        <textarea name="ciphertext" rows="4" cols="70"></textarea></p>

    <p>
        Ciphertext (base64):<br>
        <textarea name="cipherb64" rows="3" cols="70"></textarea></p>

    <p>
        Status:<br>
        <input name="status" type="text" size="40"></p>

    <p>
    </p>
    <hr>
    <h2>RSA public key</h2>

    <p>
        Public exponent (hex, F4=0x10001):<br>
        <input name="e" type="text" value="3" size="20"></p>

    <p>
        Modulus (hex):<br>
        <textarea name="n" type="text" rows="4" cols="70"></textarea><br>
        <input type="button" value="1024 bit" onclick="set_1024f4();">
        <input type="button" value="1024 bit (e=3)" onclick="set_1024e3();">
        <input type="button" value="512 bit" onclick="set_512f4();">
        <input type="button" value="512 bit (e=3)" onclick="set_512e3();">
    </p>
</form>

<span class="highlight">
    <script language="JavaScript" type="text/javascript" src="//ajax.googleapis.com/ajax/libs/angularjs/1.4.7/angular.min.js"></script>
    <script language="JavaScript" type="text/javascript" src="./js/vendor/jsbn.js"></script>
    <script language="JavaScript" type="text/javascript" src="./js/vendor/prng4.js"></script>
    <script language="JavaScript" type="text/javascript" src="./js/vendor/rng.js"></script>
    <script language="JavaScript" type="text/javascript" src="./js/vendor/rsa.js"></script>
    <script language="JavaScript" type="text/javascript" src="./js/vendor/base64.js"></script>
</span>
</body>
</html>